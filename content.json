{"meta":{"title":"Vanch's Blog","subtitle":"æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸–ç•Œ","description":"å˜¿å˜¿å˜¿ï½","author":"Vanch","url":"https://vanchchen.github.io"},"pages":[{"title":"","date":"2018-09-14T09:54:31.903Z","updated":"2017-11-07T01:57:43.000Z","comments":true,"path":"404.html","permalink":"https://vanchchen.github.io/404.html","excerpt":"","text":"404"},{"title":"","date":"2018-10-08T01:55:15.827Z","updated":"2018-10-08T01:55:15.827Z","comments":true,"path":"google706759de818b3de4.html","permalink":"https://vanchchen.github.io/google706759de818b3de4.html","excerpt":"","text":"google-site-verification: google706759de818b3de4.html"},{"title":"","date":"2018-10-08T01:55:15.826Z","updated":"2018-10-08T01:55:15.826Z","comments":true,"path":"baidu_verify_taFsHIjAWm.html","permalink":"https://vanchchen.github.io/baidu_verify_taFsHIjAWm.html","excerpt":"","text":"taFsHIjAWm"},{"title":"æˆ‘æ˜¯è°ï¼Ÿ","date":"2018-10-06T07:34:27.000Z","updated":"2018-10-08T01:55:15.826Z","comments":true,"path":"about/index.html","permalink":"https://vanchchen.github.io/about/index.html","excerpt":"","text":"@card{ æˆ‘å«é™ˆæ–‡ç¦ï¼Œè‹±æ–‡åVanchï¼Œç°å±…ä¸Šæµ·ï¼Œä»äº‹iOSå¼€å‘å·¥ä½œï¼Œå¯¹ä»£ç æœ‰ç‚¹å¼ºè¿«ç—‡ã€‚ è¿‘æœŸæ‰å†³å®šæŠŠæœ€è¿‘æ‰€å­¦æ•´ç†æˆåšå®¢è®°å½•ä¸‹æ¥ï¼Œç›®å‰ä¸»è¦æ–¹å‘ä¸ºé¢è¯•é¢˜å‡†å¤‡ã€‚ åšä¿¡çŸ¥è¯†åªæœ‰æ•´ç†æˆè‡ªå·±çš„æ–‡å­—ï¼Œæ‰ç®—ç†è§£å­¦ä¼šã€‚ } å…´è¶£@column-2{ @card{ å·¦è„‘ä¸»æ”» iOSï¼ŒLinux åŸç†å®ç°ä¸å„ç§æœ‰æ„æ€çš„è¯¾é¢˜ æ­£åœ¨å­¦Shellè„šæœ¬æé«˜æ•ˆç‡ å‡†å¤‡è¾¹å­¦ Swift4.4 è¾¹å­¦ç®—æ³• çœŸå¤Ÿè´ªå¿ƒ ä¼šCocoså¼€å‘å¾®ä¿¡å°æ¸¸æˆ å¯¹Pythonæœ‰å…´è¶£ } @card{ å³è„‘å–œæ¬¢è¯»æ–‡å­¦ã€æ¨ç†ã€å†å²ä¹¦ç± å¤§çˆ±å¤å…¸éŸ³ä¹ï¼Œä½†ä¹Ÿå–œæ¬¢Rap ä»€ä¹ˆé¬¼.. å‰ä»– åªä¼šçˆ¬éŸ³é˜¶ å›´æ£‹ åˆçº§ç”µè„‘éƒ½æ‰“ä¸è¿‡ ç”»ç”» åªä¼šç®€ç¬”ç”» } } æ±‚å‹¾æ­@card{ æ¬¢è¿å¤§å®¶å’Œæˆ‘äº¤æµï½ å¾®ä¿¡ï¼šVanch0714 é‚®ç®±ï¼š447389831@qq.com å¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæœ‰æ—¶é—´æˆ‘éƒ½ä¼šå›å¤ï¼ }"},{"title":"categories","date":"2018-09-14T09:13:36.000Z","updated":"2018-09-14T09:15:05.482Z","comments":false,"path":"categories/index.html","permalink":"https://vanchchen.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-09-14T09:00:14.000Z","updated":"2018-09-14T09:14:24.713Z","comments":false,"path":"tags/index.html","permalink":"https://vanchchen.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"è„šæœ¬å¤„ç†iOSçš„Crashæ—¥å¿—","slug":"è„šæœ¬è§£æCrash","date":"2018-10-08T08:06:38.000Z","updated":"2018-10-08T08:10:13.268Z","comments":true,"path":"p/2616.html","link":"","permalink":"https://vanchchen.github.io/p/2616.html","excerpt":"","text":"èƒŒæ™¯å½“æˆ‘ä»¬æ‰“åŒ…appæ—¶ï¼Œå¯ä»¥é€‰æ‹©ç”Ÿæˆå¯¹åº”çš„ç¬¦å·è¡¨ï¼Œå…¶ä¿å­˜ 16 è¿›åˆ¶å‡½æ•°åœ°å€æ˜ å°„ä¿¡æ¯ï¼Œé€šè¿‡ç»™å®šçš„å‡½æ•°èµ·å§‹åœ°å€å’Œåç§»é‡ï¼Œå¯ä»¥å¯¹åº”å‡½æ•°å…·ä½“ä¿¡æ¯ä»¥ä¾›åˆ†æã€‚ æ‰€ä»¥æˆ‘ä»¬æ‹¿åˆ°æµ‹è¯•ç»™çš„é—ªé€€æ—¥å¿—(.crash)æ—¶ï¼Œéœ€è¦æ‰¾åˆ°æ‰“åŒ…æ—¶å¯¹åº”ç”Ÿæˆçš„ç¬¦å·è¡¨(.dSYM)ä½œä¸ºé’¥åŒ™è§£æã€‚å…·ä½“åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ­¥éª¤ dwarfdump --uuid å‘½ä»¤è·å– .dSYM çš„ uuid æ‰“å¼€ .crash æ–‡ä»¶ï¼Œåœ¨ç‰¹å®šä½ç½®æ‰¾åˆ° uuid æ ¹æ® arm ç‰ˆæœ¬æ¯”å¯¹ä¸¤è€…æ˜¯å¦ä¸€è‡´ åˆ° Xcode ç›®å½•ä¸‹å¯»æ‰¾ symbolicatecrash å·¥å…· ä¸åŒç‰ˆæœ¬æ–‡ä»¶è·¯å¾„ä¸åŒï¼Œå…·ä½“ç‰ˆæœ¬è¯·è°·æ­Œã€‚Xcode9è·¯å¾„æ˜¯/Applications/Xcode.app/Contents/SharedFrameworks/DVTFoundation.framework/Versions/A/Resources/ è®¾ç½®ç»ˆç«¯ç¯å¢ƒå˜é‡ export DEVELOPER_DIR=&quot;/Applications/Xcode.app/Contents/Developer&quot; ä½¿ç”¨ symbolicatecrash å·¥å…·è§£ææ—¥å¿— symbolicatecrash .crash .dsym &gt; a.out è™½ç„¶è¿‡ç¨‹ä¸å¤æ‚ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡æ£€æŸ¥ä¸å‘½ä»¤ï¼Œè¿‡äºç¹çï¼Œæ‰€ä»¥å†³å®šç”¨è„šæœ¬åŒ–æé«˜æ•ˆç‡ã€‚ æ­¥éª¤å®ç°è¾“å…¥Crashæ—¥å¿—123#è¦æ±‚è¾“å…¥crashæ–‡ä»¶è·¯å¾„inputFile 'Please Input Crash File' 'crash'crashPath=$filePath ç”±äºéœ€è¦è¾“å…¥ä¸¤ç§ä¸åŒåç¼€çš„æ–‡ä»¶è·¯å¾„ï¼Œä¸”éƒ½éœ€è¦æ£€æŸ¥ï¼Œå› æ­¤ç»Ÿä¸€å®šä¹‰ä¸€ä¸ªæ–¹æ³•ã€‚123456789101112131415161718#å®šä¹‰å…¨å±€å˜é‡filePath=#è¾“å…¥æ–‡ä»¶è·¯å¾„inputFile() &#123; readSuccess=false #é¦–å…ˆæ¸…ç©ºå˜é‡å€¼ filePath= while [ $readSuccess = false ]; do echo $1 #è¯»å–åˆ°å˜é‡ä¸­ read -a filePath if [[ ! -e $filePath || $&#123;filePath##*.&#125; != $2 ]]; then echo \"Input file is not .\"$2 else readSuccess=true fi done&#125; \b.dSYM æ˜¯æ–‡ä»¶å¤¹è·¯å¾„ï¼Œæ‰€ä»¥è¿™é‡Œç®€å•çš„åˆ¤æ–­äº†\bè·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±ç»§ç»­è®©ç”¨æˆ·è¾“å…¥ã€‚ Shellå‘½ä»¤\bä¸­åˆ¤æ–­åˆ†ä¸º[]ä¸[[]]ï¼Œåè€…æ¯”å‰è€…æ›´é€šç”¨ï¼Œå¯ä»¥ä½¿ç”¨ || æ­£åˆ™è¿ç®—ç­‰ã€‚ åˆ¤æ–­ä¸­ï¼Œ-fè¡¨ç¤ºæ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥æ–‡ä»¶ï¼Œ-dè¡¨ç¤ºæ£€æŸ¥æ˜¯å¦å­˜åœ¨æ–‡ä»¶å¤¹ï¼Œ-eè¡¨ç¤ºæ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥è·¯å¾„ è¾“å…¥dSYMç¬¦å·è¡¨1234567891011121314dsymSuccess=falsewhile [ $dsymSuccess = false ]; do #è¦æ±‚è¾“å…¥dSYMæ–‡ä»¶è·¯å¾„ inputFile 'Please Input dSYM File' 'dSYM' dsymPath=$filePath #æ£€æŸ¥æ˜¯å¦åŒ¹é… checkUUID \"$crashPath\" \"$dsymPath\" match=$? if [ $match -eq 0 ]; then echo 'UUID not match!' else dsymSuccess=true fidone å¾ªç¯è·å–åŒ¹é… UUID çš„\b dSYM ï¼Œè¿™é‡Œä½¿ç”¨äº†å¦ä¸€ç§æ–¹æ³•è·å–æ–¹æ³•è¿”å›å€¼ï¼Œå…·ä½“ä¹‹åç« èŠ‚ä¼šæ€»ç»“ã€‚ æŸ¥æ‰¾symbolicatecrashå·¥å…·\båœ¨ Xcode æ–‡ä»¶å¤¹æŒ‡å®šè·¯å¾„ä¸‹æŸ¥æ‰¾å·¥å…·ï¼ŒåŠ å¿«æ•ˆç‡ï¼Œå¦‚æœæ²¡æ‰¾åˆ°å°±åœæ­¢è¿è¡Œã€‚ 123456# æŸ¥æ‰¾symbolicatecrashè§£æå·¥å…·ï¼Œå†…ç½®åœ¨Xcodeçš„åº“æ–‡ä»¶ä¸­toolPath=`find /Applications/Xcode.app/Contents/SharedFrameworks -name symbolicatecrash | head -n 1`if [ ! -f $toolPath ]; then echo \"Symbolicatecrash not exist!\" exit 0fi æ‰§è¡Œè§£æå‘½ä»¤1234567#å…ˆè®¾ç½®ç¯å¢ƒå˜é‡export DEVELOPER_DIR=\"/Applications/Xcode.app/Contents/Developer\"#æŒ‡å®šè§£æç»“æœè·¯å¾„crashName=`basename $crashPath`afterPath=\"$(dirname \"$crashPath\")\"/\"$&#123;crashName%%.*&#125;\"\"_after.crash\"#å¼€å§‹è§£æ$toolPath \"$crashPath\" \"$dsymPath\" &gt; \"$afterPath\" 2&gt; /dev/null è¿™é‡Œæˆ‘å°†é”™è¯¯ä¿¡æ¯å¯¼æµåˆ° /\bdev/nullï¼Œä¿è¯è§£ææ–‡ä»¶æ²¡æœ‰æ‚ä¹±ä¿¡æ¯ã€‚ é‡åˆ°çš„é—®é¢˜æ€ä¹ˆè·å–å‡½æ•°è¿”å›\bå€¼ï¼Ÿ\bä¹‹å‰æ²¡æœ‰\bå¤„ç†è¿‡éœ€è¦è¿”å›æ•°å€¼çš„æ–¹æ³•ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æœ‰ç‚¹æ‡µï¼Œ\b\bæŸ¥è¯¢èµ„æ–™åæœ€ç»ˆé‡‡ç”¨äº†ä¸¤ç§\bæ–¹å¼\bå®ç°äº†æ•ˆæœï¼Œç°åœ¨åšä¸€äº›æ€»ç»“ã€‚ å…¨å±€å˜é‡è®°å½•12345678#å®šä¹‰å…¨å±€å˜é‡filePath=inputFile() &#123; #è¯»å–åˆ°å˜é‡ä¸­ read -a filePath&#125;inputFilecrashPath=$filePath é€šè¿‡ inputFile æ–¹æ³•æ¥\bäº†è§£ä¸€ä¸‹ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ä¸º filePathï¼Œåœ¨æ–¹æ³•ä¸­é‡æ–°èµ‹å€¼ï¼Œæ–¹æ³•ç»“æŸåè¯»å–å…¨å±€å˜é‡ä¸­çš„æ•°æ®ã€‚ è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯å¯ä»¥è‡ªå®šä¹‰è¿”å›å‚æ•°ç±»å‹å’Œä¸ªæ•°ï¼Œç¼ºç‚¹æ˜¯å®¹æ˜“å’Œå…¶ä»–å˜é‡ææ··ã€‚ Returnè¿”å›å€¼ç±»ä¼¼ä¸Cè¯­è¨€ä¸­çš„ç”¨æ³•ï¼Œ\bè„šæœ¬ä¹Ÿæ”¯æŒ retrun 0 è¿”å›ç»“æœå¹¶åœæ­¢è¿è¡Œã€‚ 123456789checkUUID() &#123; grep \"$arm64id\" \"$1\" if [ $? -ne 0 ]; then return 1; fi return 0;&#125;checkUUID \"$crashPath\" \"$dsymPath\"match=$? è·å–ç»“æœçš„æ–¹å¼ä¸º $?ï¼Œå…¶èƒ½å¤Ÿè¿”å›ç¯å¢ƒä¸­æœ€åä¸€ä¸ªæŒ‡ä»¤ç»“æœï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰æ‰§è¡Œçš„checkUUIDçš„ç»“æœã€‚ ä¼˜ç‚¹æ˜¯ç®€æ´æ˜äº†ï¼Œç¬¦åˆç¼–ç ä¹ æƒ¯ï¼Œç¼ºç‚¹æ˜¯è¿”å›å€¼åªèƒ½æ˜¯ 0-255 çš„æ•°å­—ï¼Œä¸èƒ½è¿”å›å…¶ä»–ç±»å‹çš„æ•°æ®ã€‚ è·å–æ‰“å°å€¼è¿˜æœ‰ä¸€ç§æ–¹æ³•å…¶å®å¹³æ—¶ä¸€ç›´åœ¨ä½¿ç”¨ï¼Œåªä¸è¿‡å¹¶ä¸äº†è§£å…¶è¿è¡Œ\bæ–¹å¼ã€‚123456crashName=`basename $crashPath`print() &#123; echo \"Hello World\"&#125;text=$(print) è¿è¡Œç³»ç»Ÿé¢„è®¾çš„æ–¹æ³•æˆ–è€…\bè‡ªå®šä¹‰æ–¹æ³•ï¼Œå°†\bæ‰§è¡Œå‘½ä»¤ç”¨ $() çš„æ–¹å¼ä½¿ç”¨ï¼Œå°±å¯ä»¥è·å–è¯¥å‘½ä»¤ä¸­æ‰€æœ‰æ‰“å°çš„ä¿¡æ¯ï¼Œèµ‹å€¼åˆ°å˜é‡å°±å¯ä»¥æ‹¿åˆ°éœ€è¦çš„è¿”å›å€¼ã€‚ ä¼˜ç‚¹æ˜¯åŠŸèƒ½å…¨æ•ˆç‡é«˜ï¼Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼å¯ä»¥ä¼ é€’å®šåˆ¶åŒ–ä¿¡æ¯ï¼Œç¼ºç‚¹æ˜¯ä¸å¯é¢„æœŸè¿”å›ç»“æœï¼Œéœ€è¦é€šè¿‡å­—ç¬¦ä¸²\bæŸ¥æ‰¾ç­‰å‘½ä»¤\b\bè¾…åŠ©ã€‚ å¾ªç¯è¾“å…¥\båˆæ³•è·¯å¾„åœ¨æˆ‘çš„è®¾æƒ³ä¸­ï¼Œéœ€è¦ç”¨æˆ·è¾“å…¥åŒ¹é…çš„ \bdSYM æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœ\bä¸åŒ¹é…ï¼Œåˆ™é‡æ–°è¾“å…¥ï¼Œç›´åˆ°åˆæ³•ã€‚ä¸ºäº†æ”¯æŒåµŒå¥—ï¼Œéœ€è¦å®šä¹‰å±€éƒ¨å˜é‡æ§åˆ¶å¾ªç¯ï¼Œ\bå…·ä½“ä»£ç å¦‚ä¸‹1234567891011121314dsymSuccess=falsewhile [ $dsymSuccess = false ]; do #è¦æ±‚è¾“å…¥dSYMæ–‡ä»¶è·¯å¾„ inputFile 'Please Input dSYM File' 'dSYM' dsymPath=$filePath #æ£€æŸ¥æ˜¯å¦åŒ¹é… checkUUID \"$crashPath\" \"$dsymPath\" match=$? if [ $match -eq 0 ]; then echo 'UUID not match!' else dsymSuccess=true fidone \b### å¤„ç†å­—ç¬¦ä¸² è·å–åˆ° UUID æ‰€æœ‰è¾“å‡ºä¿¡æ¯åï¼Œéœ€è¦æˆªå–å‡ºå¯¹åº”å¹³å°çš„ä¿¡æ¯ï¼Œ\bå¤„ç†è¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰ï¼Œç‰¹åœ°æ•´ç†å¦‚ä¸‹1234567891011121314151617#åŸå§‹ä¿¡æ¯UUID: 92E495AA-C2D4-3E9F-A759-A50AAEF446CD (armv7) /Volumes/.dSYM/Contents/Resources/DWARF/appUUID: 536527A8-0243-34DB-AE08-F1F64ACA4351 (arm64) /Volumes/.dSYM/Contents/Resources/DWARF/app#å»é™¤ä¸­é—´é—´éš”-uuid=$&#123;uuid//-/&#125;#\bä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ª\båŒ¹é… \\(arm64çš„ï¼Œå¹¶ä¸”éƒ½åˆ é™¤arm64id=$&#123;uuid% \\(arm64*&#125;#å¤„ç†åUUID: 92E495AAC2D43E9FA759A50AAEF446CD (armv7) /Volumes/.dSYM/Contents/Resources/DWARF/appUUID: 536527A8024334DBAE08F1F64ACA4351#ä»å‰å¾€åæ‰¾æœ€åä¸€ä¸ªUUID: ï¼Œ\bå¹¶åˆ é™¤arm64id=$&#123;arm64id##*UUID: &#125;#å¤„ç†å 536527A8024334DBAE08F1F64ACA4351 æ€»ç»“çœ‹ä¼¼ç®€å•çš„è„šæœ¬ï¼Œä¹ŸèŠ±äº†\bä¸€å¤©æ—¶é—´ç¼–å†™ï¼Œæ€»ä½“è¿˜æ˜¯ä¸å¤ªç†Ÿç»ƒï¼Œä»éœ€åŠªåŠ›è”ç³»ã€‚ è¿™æ¬¡ç‰¹åœ°å°è¯•äº†ä¸ä¸Šæ¬¡ä¸åŒçš„å‚æ•°è¾“å…¥æ–¹æ³•ï¼Œä½¿ç”¨æç¤ºè¾“å…¥çš„æ–¹å¼ï¼Œæœç„¶é‡åˆ°äº†æ–°çš„é—®é¢˜ã€‚å¥½åœ¨éƒ½æŸ¥èµ„æ–™è§£å†³äº†ï¼Œç»“æœ\bè¿˜ç®—æ»¡æ„ã€‚ è„šæœ¬æˆ‘æäº¤åˆ°äº†Githubï¼Œæ¬¢è¿å¤§å®¶æŒ‡æ•™å…±åŒè¿›æ­¥ï¼ç»™ä¸ªå…³æ³¨æœ€å¥½å•¦ï½","categories":[{"name":"Shell","slug":"Shell","permalink":"https://vanchchen.github.io/categories/Shell/"}],"tags":[]},{"title":"AssociatedObjectå…³è”å¯¹è±¡åŸç†å®ç°","slug":"AssociatedObjectåŸç†å®ç°","date":"2018-09-29T09:55:21.000Z","updated":"2018-10-08T01:55:15.821Z","comments":true,"path":"p/f39e.html","link":"","permalink":"https://vanchchen.github.io/p/f39e.html","excerpt":"","text":"ä»‹ç»å…³è”å¯¹è±¡ï¼ˆAssociatedObjectï¼‰æ˜¯Objective-C 2.0è¿è¡Œæ—¶çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå…è®¸å¼€å‘è€…å¯¹å·²ç»å­˜åœ¨çš„ç±»åœ¨æ‰©å±•ä¸­æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§ã€‚åœ¨å®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼æ˜¯ç»™åˆ†ç±»ï¼ˆCategoryï¼‰æ·»åŠ æˆå‘˜å˜é‡ã€‚ \bä¾‹å­1234567891011121314151617181920#import &lt;objc/runtime.h&gt;@interface NSObject (AssociatedObject)@property (nonatomic, strong) id property;@end@implementation NSObject (AssociatedObject)@dynamic property;- (\bid)property &#123; return objc_getAssociatedObject(self, _cmd);&#125;- (void)setProperty:(NSString *)property &#123; objc_setAssociatedObject(self, @selector(property), property, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;@end é€šè¿‡å®ç°ä»£ç å¯ä»¥\bç¨å¾®åˆ†æä¸‹ï¼Œ\bobjc_getAssociatedObject æ‹¿ç€ä¸å˜çš„\bæŒ‡é’ˆåœ°å€ï¼ˆç¤ºä¾‹ä¼ å…¥selectorä½œä¸ºå‚æ•°ï¼Œå®é™…æ˜¯void*ï¼‰ï¼Œä»\bå®ä¾‹ä¸­è·å–éœ€è¦çš„å¯¹è±¡ã€‚objc_setAssociatedObject æ ¹æ®ä¼ å…¥çš„å‚æ•°åè®®ï¼Œä¿å­˜æŒ‡å®šçš„å¯¹è±¡ã€‚ å‚æ•°åè®®1234567typedef OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &#123; OBJC_ASSOCIATION_ASSIGN = 0, /**&lt; Specifies a weak reference to the associated object. */ OBJC_ASSOCIATION_RETAIN_NONATOMIC = 1, /**&lt; Specifies a strong reference to the associated object. The association is not made atomically. */ OBJC_ASSOCIATION_COPY_NONATOMIC = 3, /**&lt; Specifies that the associated object is copied. The association is not made atomically. */ OBJC_ASSOCIATION_RETAIN = 01401, /**&lt; Specifies a strong reference to the associated object. The association is made atomically. */ OBJC_ASSOCIATION_COPY = 01403 /**&lt; Specifies that the associated object is copied. The association is made atomically. */&#125;; å…¶å®è¿™äº”ä¸ªåè®®å°±æ˜¯æˆ‘ä»¬å¹³æ—¶å®šä¹‰å±æ€§æ—¶ä½¿ç”¨çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶è‹¹æœåœ¨æ³¨é‡Šä¸­è¯´ OBJC_ASSOCIATION_ASSIGN ç›¸å½“äºä¸€ä¸ª weak referenceï¼Œä½†å…¶å®\bç­‰äº \bassign/unsafe_unretainedã€‚ å¯¹äºä¸weakçš„åŒºåˆ«ä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…ï¼Œ\bæµ…æ˜¾çš„åŒºåˆ«åœ¨äºå˜é‡é‡Šæ”¾åï¼Œweak ä¼šæŠŠå¼•ç”¨ç½®ç©ºï¼Œunsafe_unretainedä¼šä¿ç•™å†…å­˜åœ°å€ï¼Œ\bä¸€æ—¦è·å–å¯èƒ½ä¼šé‡æŒ‡é’ˆé—ªé€€ã€‚ æ€»ç»“\bæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœç±»è¦\bæ·»åŠ å˜é‡ï¼Œåªæœ‰åœ¨\bobjc_allocateClassPairä¸objc_registerClassPairä¹‹é—´addIvarã€‚ç­‰ç±»æ³¨å†Œåï¼Œå˜é‡ç»“æ„å°±ä¸å…è®¸å†è¢«æ”¹å˜ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢ä¸¤ä¸ª\bç›¸åŒç±»çš„å®ä¾‹æ‹¥æœ‰ä¸åŒå˜é‡å¯¼è‡´\bè¿è¡Œå›°æƒ‘ã€‚ é‚£ä¹ˆåœ¨runtimeæ—¶ç»™å®ä¾‹æ·»åŠ å˜é‡ï¼Œåˆä¸æ”¹å˜ç±»å†…éƒ¨å˜é‡ç»“æ„ï¼Œå…³è”å¯¹è±¡å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„åšæ³•ã€‚ å…³è”å¯¹è±¡çš„å®ç°å¤–éƒ¨æ–¹æ³•12345678//Sets an associated value for a given object using a given key and association policy.void objc_setAssociatedObject(id object, const void * key, id value, objc_AssociationPolicy policy);//Returns the value associated with a given object for a given key.id objc_getAssociatedObject(id object, const void * key);//Removes all associations for a given object.void objc_removeAssociatedObjects(id object); \bç›¸æ¯”åˆšåˆšä¾‹å­ä¸­çš„ç”¨æ³•ï¼Œ\bå¤šäº†ä¸€ä¸ªobjc_removeAssociatedObjectsï¼Œé‚£ä¹ˆå¯ä¸å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥åˆ é™¤ä¸ç”¨çš„å…³è”å¯¹è±¡å‘¢ï¼Ÿ è‹¹æœçš„æ–‡æ¡£ä¸­è§£é‡Šè¯´\bè¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨æ¥è¿˜åŸå¯¹è±¡åˆ°ç±»åˆå§‹çš„çŠ¶æ€ï¼Œä¼šç§»é™¤æ‰€æœ‰çš„å…³è”ï¼ŒåŒ…æ‹¬å…¶ä»–æ¨¡å—æ·»åŠ çš„ï¼Œå› æ­¤åº”è¯¥\bç”¨ objc_setAssociatedObject(..,nil,..) çš„æ–¹å¼å»å¸è½½ã€‚ \bSetterå®ç°objc_setAssociatedObjectå®é™…è°ƒç”¨çš„æ˜¯_object_set_associative_reference 1234567891011121314151617181920212223242526272829303132333435363738394041424344void _object_set_associative_reference(id object, void *key, id value, uintptr_t policy) &#123; // retain the new value (if any) outside the lock. ObjcAssociation old_association(0, nil); id new_value = value ? acquireValue(value, policy) : nil; &#123; AssociationsManager manager; AssociationsHashMap &amp;associations(manager.associations()); disguised_ptr_t disguised_object = DISGUISE(object); if (new_value) &#123; // break any existing association. AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; // secondary table exists ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; old_association = j-&gt;second; j-&gt;second = ObjcAssociation(policy, new_value); &#125; else &#123; (*refs)[key] = ObjcAssociation(policy, new_value); &#125; &#125; else &#123; // create the new association (first time). ObjectAssociationMap *refs = new ObjectAssociationMap; associations[disguised_object] = refs; (*refs)[key] = ObjcAssociation(policy, new_value); object-&gt;setHasAssociatedObjects(); &#125; &#125; else &#123; // setting the association to nil breaks the association. AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; old_association = j-&gt;second; refs-&gt;erase(j); &#125; &#125; &#125; &#125; // release the old value (outside of the lock). if (old_association.hasValue()) ReleaseValue()(old_association);&#125; \bå†…å­˜ç®¡ç†12345678910111213141516171819202122static id acquireValue(id value, uintptr_t policy) &#123; switch (policy &amp; 0xFF) &#123; case OBJC_ASSOCIATION_SETTER_RETAIN: return objc_retain(value); case OBJC_ASSOCIATION_SETTER_COPY: return ((id(*)(id, SEL))objc_msgSend)(value, SEL_copy); &#125; return value;&#125;static void releaseValue(id value, uintptr_t policy) &#123; if (policy &amp; OBJC_ASSOCIATION_SETTER_RETAIN) &#123; return objc_release(value); &#125;&#125;ObjcAssociation old_association(0, nil);id new_value = value ? acquireValue(value, policy) : nil;&#123; old_association = ...&#125;if (old_association.hasValue()) ReleaseValue()(old_association); æˆ‘ä»¬æ‘˜å‡ºä¸å¯¹è±¡\bå†…å­˜ç›¸å…³çš„\bä»£ç ä»”ç»†åˆ†æä¸‹ï¼Œé¦–å…ˆæŠŠæ–°ä¼ å…¥çš„å¯¹è±¡ï¼Œæ ¹æ®åè®®è¿›è¡Œretain/copyï¼Œåœ¨èµ‹å€¼çš„è¿‡ç¨‹ä¸­è·å–\bæ—§å€¼ï¼Œåœ¨æ–¹æ³•ç»“æŸå‰releaseã€‚ \bèµ‹å€¼1234567891011121314151617181920212223242526AssociationsManager manager;AssociationsHashMap &amp;associations(manager.associations());disguised_ptr_t disguised_object = DISGUISE(object);if (new_value) &#123; //éœ€è¦\bèµ‹å€¼ AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; //æ‰¾åˆ°äº†è¿™ä¸ªå¯¹è±¡çš„å…³è”è¡¨ ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; //æ‰¾åˆ°äº†è¿™ä¸ªkeyçš„å…³è”å¯¹è±¡ old_association = j-&gt;second; j-&gt;second = ObjcAssociation(policy, new_value); &#125; else &#123; //æ²¡æ‰¾åˆ°ï¼Œæ–°å¢ä¸€ä¸ªå…³è” (*refs)[key] = ObjcAssociation(policy, new_value); &#125; &#125; else &#123; //æ²¡æ‰¾åˆ°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å…³è”è¡¨ ObjectAssociationMap *refs = new ObjectAssociationMap; associations[disguised_object] = refs; (*refs)[key] = ObjcAssociation(policy, new_value); object-&gt;setHasAssociatedObjects(); &#125;&#125; å…ˆäº†è§£ä¸€ä¸‹\bAssociationsManagerä¸AssociationsHashMap12345678910111213class AssociationsManager &#123; static AssociationsHashMap *_map;public: AssociationsHashMap &amp;associations() &#123; if (_map == NULL) _map = new AssociationsHashMap(); return *_map; &#125;&#125;;class AssociationsHashMap : public unordered_map&lt;disguised_ptr_t, ObjectAssociationMap *, DisguisedPointerHash, DisguisedPointerEqual, AssociationsHashMapAllocator&gt;;class ObjectAssociationMap : public std::map&lt;void *, ObjcAssociation, ObjectPointerLess, ObjectAssociationMapAllocator&gt;ï¼› AssociationsManageré€šè¿‡ä¸€ä¸ªä»¥æŒ‡é’ˆåœ°å€ä¸ºä¸»é”®ï¼Œå€¼ä¸ºå…³è”è¡¨çš„å“ˆå¸Œè¡¨ï¼Œæ¥ç®¡ç†åº”ç”¨å†…æ‰€æœ‰çš„å…³è”å¯¹è±¡ã€‚ é¦–å…ˆä»¥å¯¹è±¡çš„æŒ‡é’ˆåœ°å€å»å¯»æ‰¾å…³è”è¡¨ï¼Œå†é€šè¿‡æŒ‡å®šçš„\bé”®å€¼æŸ¥æ‰¾å…³è”å…³ç³»ï¼Œä»è€Œè·å–å…³è”å¯¹è±¡ã€‚ åˆ é™¤123456789AssociationsHashMap::iterator i = associations.find(disguised_object);if (i != associations.end()) &#123; ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; old_association = j-&gt;second; refs-&gt;erase(j); &#125;&#125; å’Œä¿®æ”¹æ–¹æ³•ç±»ä¼¼ï¼Œæ‰¾åˆ°å…³è”å…³ç³»åï¼Œ\bæ‰§è¡Œå“ˆå¸Œè¡¨çš„eraseæ–¹æ³•åˆ é™¤ã€‚ \bGetterå®ç°objc_getAssociatedObjectå®é™…è°ƒç”¨çš„æ˜¯_object_get_associative_reference 1234567891011121314151617181920212223242526id _object_get_associative_reference(id object, void *key) &#123; id value = nil; uintptr_t policy = OBJC_ASSOCIATION_ASSIGN; &#123; AssociationsManager manager; AssociationsHashMap &amp;associations(manager.associations()); disguised_ptr_t disguised_object = DISGUISE(object); AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; ObjcAssociation &amp;entry = j-&gt;second; value = entry.value(); policy = entry.policy(); if (policy &amp; OBJC_ASSOCIATION_GETTER_RETAIN) &#123; objc_retain(value); &#125; &#125; &#125; &#125; if (value &amp;&amp; (policy &amp; OBJC_ASSOCIATION_GETTER_AUTORELEASE)) &#123; objc_autorelease(value); &#125; return value;&#125; æŸ¥æ‰¾å“ˆå¸Œè¡¨çš„æ–¹æ³•å’ŒSetterä¸€æ ·ï¼ŒåŒºåˆ«åœ¨äºå¦‚æœç­–ç•¥ä¸­éœ€è¦retainå’Œautoreleaseçš„è¯ï¼Œ\béƒ½éœ€è¦å¤„ç†ã€‚é‚£ä¹ˆæ˜¯æ€ä¹ˆçº¦å®šè¿™äº›ç­–ç•¥å‘¢ï¼Ÿ 12345678910111213141516enum &#123; OBJC_ASSOCIATION_SETTER_ASSIGN = 0, OBJC_ASSOCIATION_SETTER_RETAIN = 1, OBJC_ASSOCIATION_SETTER_COPY = 3, // NOTE: both bits are set, so we can simply test 1 bit in releaseValue below. OBJC_ASSOCIATION_GETTER_READ = (0 &lt;&lt; 8), OBJC_ASSOCIATION_GETTER_RETAIN = (1 &lt;&lt; 8), OBJC_ASSOCIATION_GETTER_AUTORELEASE = (2 &lt;&lt; 8)&#125;; typedef OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &#123; OBJC_ASSOCIATION_ASSIGN = 0, OBJC_ASSOCIATION_RETAIN_NONATOMIC = 1, OBJC_ASSOCIATION_COPY_NONATOMIC = 3, OBJC_ASSOCIATION_RETAIN = 01401, OBJC_ASSOCIATION_COPY = 01403&#125;; \bOBJC_ASSOCIATION_RETAIN = 01401ï¼Œå…¶ä¸­01401å¼€å¤´æ˜¯0ï¼Œæ‰€ä»¥æ˜¯å…«è¿›åˆ¶æ•°å­—ï¼Œç¿»è¯‘ä¸ºäºŒè¿›åˆ¶å°±æ˜¯0000 0011 0000 0001ï¼Œ\b\bå–ä½åˆ¤æ–­\bå°±æ˜¯OBJC_ASSOCIATION_SETTER_RETAIN OBJC_ASSOCIATION_GETTER_RETAIN OBJC_ASSOCIATION_GETTER_AUTORELEASEã€‚ åœ¨ä¿å­˜çš„æ—¶å€™ï¼Œéœ€è¦retainï¼Œåœ¨è·å–çš„æ—¶å€™ï¼Œéœ€è¦å…ˆretainå¢åŠ å¼•ç”¨è®¡æ•°ï¼Œå†æ‰§è¡Œ\bautoreleaseç­‰å¾…é‡Šæ”¾ï¼Œä»è€Œå®ç°åŸå­æ€§ã€‚ Removeå®ç°objc_removeAssociatedObjectsä¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨å…³è”ï¼Œç„¶åå†æ‰§è¡Œ_object_set_associative_reference12345678910111213141516171819202122void _object_remove_assocations(id object) &#123; vector&lt; ObjcAssociation,ObjcAllocator&lt;ObjcAssociation&gt; &gt; elements; &#123; AssociationsManager manager; AssociationsHashMap &amp;associations(manager.associations()); if (associations.size() == 0) return; disguised_ptr_t disguised_object = DISGUISE(object); AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; // copy all of the associations that need to be removed. ObjectAssociationMap *refs = i-&gt;second; for (ObjectAssociationMap::iterator j = refs-&gt;begin(), end = refs-&gt;end(); j != end; ++j) &#123; elements.push_back(j-&gt;second); &#125; // remove the secondary table. delete refs; associations.erase(i); &#125; &#125; // the calls to releaseValue() happen outside of the lock. for_each(elements.begin(), elements.end(), ReleaseValue());&#125; å®ç°æ–¹å¼ä¹Ÿå¯ä»¥çœ‹å‡ºä¸ºä»€ä¹ˆåœ¨ä»‹ç»é‡Œä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºä¼šéå†æ‰€æœ‰çš„å…³è”å¯¹è±¡ï¼Œå¹¶ä¸”å…¨éƒ¨é‡Šæ”¾ï¼Œå¯èƒ½ä¼šé€ æˆåˆ«çš„æ¨¡å—åŠŸèƒ½ç¼ºé™·ã€‚ åˆ¤æ–­å…³è”å¯¹è±¡æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰å…³è”å¯¹è±¡çš„å®ç°ã€‚ 123456inline bool objc_object::hasAssociatedObjects()&#123; if (isTaggedPointer()) return true; if (isa.nonpointer) return isa.has_assoc; return true;&#125; 1234567891011121314inline void objc_object::setHasAssociatedObjects()&#123; if (isTaggedPointer()) return; retry: isa_t oldisa = LoadExclusive(&amp;isa.bits); isa_t newisa = oldisa; if (!newisa.nonpointer || newisa.has_assoc) &#123; ClearExclusive(&amp;isa.bits); return; &#125; newisa.has_assoc = true; if (!StoreExclusive(&amp;isa.bits, oldisa.bits, newisa.bits)) goto retry;&#125; \b\bé»˜è®¤è¿”å›çš„ç»“æœéƒ½æ˜¯trueï¼Œåªæœ‰åœ¨64ä½ç³»ç»Ÿä¸‹ï¼Œæ‰ä¿å­˜ä¸€ä¸ªæ ‡è®°ä½ã€‚è¿™ä¹ˆå¤„ç†æˆ‘\bæ¨æµ‹æ˜¯ä¸ºäº†åŠ å¿«é‡Šæ”¾å‘¨æœŸé€Ÿåº¦ï¼Œåœ¨\bææ„\bå¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®è¿™ä¸ªæ–¹æ³•\båˆ¤æ–­æ˜¯å¦éœ€è¦é‡Šæ”¾å…³è”å¯¹è±¡ã€‚è¯•æƒ³å¦‚æœæ¯æ¬¡éƒ½æŸ¥è¯¢å“ˆå¸Œè¡¨ï¼Œæ‰§è¡Œæ•ˆç‡å¿…å®šä¼šé™ä½ï¼Œä¸å¦‚éƒ½\bå…ˆé€šè¿‡ï¼Œ\bä¹‹åå†åšå¤„ç†ã€‚ \bå…³äºnonpointerä¸åœ¨æœ¬æ–‡ä»‹ç»èŒƒå›´å†…ï¼Œç®€å•æè¿°ä¸ºåœ¨64ä½ç³»ç»Ÿä¸‹ï¼ŒæŒ‡é’ˆåœ°å€ä¿å­˜ä¸ä»…ä»…ä¸ºå†…å­˜åœ°å€ï¼Œè¿˜å­˜æœ‰å…¶ä»–\bæ ‡è®°ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœ¬æ–‡æ¶‰åŠçš„\bhas_assocã€‚ taggedPointeræ˜¯ä¸€ç§ä¼˜åŒ–\bç­–ç•¥ï¼Œ\bæŠŠç®€å•çš„æ•°å­—\bæˆ–å­—ç¬¦ä¸²ä¿¡æ¯ç›´æ¥ä¿å­˜åœ¨æŒ‡é’ˆåœ°å€ä¸­ï¼Œä»è€Œä¸ç”³è¯·é¢å¤–å†…å­˜\båŠ å¿«è¿è¡Œæ•ˆç‡ã€‚ \bæ€»ç»“\bå…³è”å¯¹è±¡çš„å®ç°ä¸å¤æ‚ï¼Œ\bä¿å­˜çš„æ–¹å¼ä¸ºä¸€ä¸ªå…¨å±€çš„å“ˆå¸Œè¡¨ï¼Œå­˜å–éƒ½é€šè¿‡æŸ¥è¯¢è¡¨æ‰¾åˆ°å…³è”æ¥æ‰§è¡Œã€‚å“ˆå¸Œè¡¨çš„ç‰¹ç‚¹å°±æ˜¯ç‰ºç‰²ç©ºé—´æ¢å–æ—¶é—´ï¼Œæ‰€ä»¥æ‰§è¡Œé€Ÿåº¦ä¹Ÿå¯ä»¥ä¿è¯ã€‚ é—®ç­”å…³è”å¯¹è±¡æœ‰ä»€ä¹ˆåº”ç”¨ï¼Ÿå…³è”å¯¹è±¡å¯ä»¥åœ¨è¿è¡Œæ—¶ç»™æŒ‡å®šå¯¹è±¡ç»‘å®šä¸€ä¸ªæœ‰\bç”Ÿå‘½\bå‘¨æœŸçš„å˜é‡ã€‚\b 1.ç”±äºä¸æ”¹å˜åŸç±»çš„å®ç°ï¼Œæ‰€ä»¥\bå¯ä»¥ç»™åŸç”Ÿç±»æˆ–è€…æ˜¯æ‰“åŒ…çš„åº“è¿›è¡Œæ‰©å±•ï¼Œä¸€èˆ¬é…åˆCategory\bå®ç°\b\bå®Œæ•´çš„åŠŸèƒ½ã€‚ 2.\bObjCç±»å®šä¹‰çš„å˜é‡ï¼Œ\bç”±äºruntimeçš„ç‰¹æ€§ï¼Œéƒ½ä¼šæš´éœ²åˆ°å¤–éƒ¨ï¼Œä½¿ç”¨å…³è”å¯¹è±¡å¯ä»¥éšè—å…³é”®å˜é‡ï¼Œä¿è¯å®‰å…¨ã€‚ 3.å¯ä»¥ç”¨äºKVOï¼Œä½¿ç”¨å…³è”å¯¹è±¡ä½œä¸ºè§‚å¯Ÿè€…ï¼Œå¯ä»¥é¿å…è§‚å¯Ÿè‡ªèº«å¯¼è‡´å¾ªç¯ã€‚ ç³»ç»Ÿå¦‚ä½•ç®¡ç†å…³è”å¯¹è±¡ï¼Ÿç³»ç»Ÿé€šè¿‡ç®¡ç†ä¸€ä¸ªå…¨å±€å“ˆå¸Œè¡¨ï¼Œ\bé€šè¿‡å¯¹è±¡æŒ‡é’ˆåœ°å€å’Œä¼ é€’çš„å›ºå®šå‚æ•°åœ°å€æ¥è·å–å…³è”å¯¹è±¡ã€‚æ ¹æ®setterä¼ å…¥çš„å‚æ•°åè®®ï¼Œæ¥ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚ å…¶è¢«é‡Šæ”¾çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨å°†å…¶æŒ‡é’ˆç½®ç©ºä¹ˆï¼Ÿå½“å¯¹è±¡è¢«é‡Šæ”¾æ—¶ï¼Œå¦‚æœè®¾ç½®çš„åè®®æ˜¯OBJC_ASSOCIATION_ASSIGNï¼Œé‚£ä¹ˆ\bä»–çš„å…³è”å¯¹è±¡ä¸ä¼š\bå‡å°‘å¼•ç”¨è®¡æ•°ï¼Œå…¶ä»–çš„åè®®éƒ½ä¼šå‡å°‘ä»è€Œé‡Šæ”¾å…³è”å¯¹è±¡ã€‚ unsafe_unretainä¸€èˆ¬è®¤ä¸ºå¤–éƒ¨æœ‰å¯¹è±¡æ§åˆ¶ï¼Œæ‰€ä»¥å¯¹è±¡ä¸ç”¨å¤„ç†ï¼Œå› æ­¤ä¸ç®¡ä»€ä¹ˆåè®®ï¼Œå¯¹è±¡é‡Šæ”¾æ—¶éƒ½æ— éœ€æ‰‹åŠ¨è®²å…³è”å¯¹è±¡ç½®ç©ºã€‚","categories":[{"name":"iOS","slug":"iOS","permalink":"https://vanchchen.github.io/categories/iOS/"}],"tags":[{"name":"åŸç†åˆ†æ","slug":"åŸç†åˆ†æ","permalink":"https://vanchchen.github.io/tags/åŸç†åˆ†æ/"}]},{"title":"åˆè¯•Shellè„šæœ¬","slug":"åˆè¯•Shellè„šæœ¬","date":"2018-09-20T08:45:12.000Z","updated":"2018-10-08T01:55:15.826Z","comments":true,"path":"p/3f22.html","link":"","permalink":"https://vanchchen.github.io/p/3f22.html","excerpt":"","text":"èƒŒæ™¯ä¸´ä¸Šçº¿å‰\bæµ‹è¯•æ¯”è¾ƒåŠªåŠ›ï¼Œé‡åˆ°é—ªé€€æˆ–è€…å…¶ä»–é—®é¢˜ï¼Œä¼šæŠŠæ—¥å¿—åŒ…æ‰“ç»™æˆ‘ï¼Œç”±äºappå†…å­˜é™åˆ¶ï¼Œç›®å‰æ¯æ¬¡æ‰“åŒ…éƒ½æ˜¯1m\bå¤§å°ï¼Œæ‰€ä»¥æœ‰æ—¶æŸ¥æ‰¾é—®é¢˜çš„ä¸Šä¸‹æ–‡æ¯”è¾ƒåƒåŠ›ã€‚åŒæ—¶ç”±äºæ—¥å¿—æ¯”è¾ƒå¤šï¼Œæ ¹æ®å…³é”®è¯è¿‡æ»¤çš„éœ€æ±‚è¶Šæ¥è¶Šé‡è¦ã€‚ äºæ˜¯å†³å®šå­¦å†™è„šæœ¬å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œ\bæ ¹æ®æˆ‘çš„è¦æ±‚ï¼Œå·¥ä½œæµç¨‹åº”è¯¥æ˜¯ä¼ å…¥å‹ç¼©åŒ…ï¼Œæ ¹æ®åç¼€åè§£å‹ï¼Œæ ¹æ®æ—¥æœŸæ’åºååˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼ŒæŒ‰éœ€è¿‡æ»¤å…³é”®è¯ã€‚ å…ˆä¸Šä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104#!/usr/bin/env bash# Created By Vanch at 2018/9/20printHelp() &#123; echo \"Uncompess log files from inputed zip\" echo \"Then Merge these logs to one file\" echo \"Supported file types: zip tar tar.gz tar.bz2\" echo echo \"Use -s for filtering socket result to socket.log\" echo echo \"Have fun!\"&#125;#å¦‚æœæ²¡è¾“å…¥å‚æ•°ï¼Œå°±æ‰“å°å¸®åŠ©ä¿¡æ¯if [ $# -eq 0 ]; then printHelp exit 0fi#æŠŠé•¿é€‰é¡¹è½¬åˆ°çŸ­é€‰é¡¹for arg in \"$@\"; do shift case \"$arg\" in \"--help\") set -- \"$@\" \"-h\" ;; \"--version\") set -- \"$@\" \"-v\" ;; \"--list\") set -- \"$@\" \"-l\" ;; *) set -- \"$@\" \"$arg\" esacdone#è·å–çŸ­é€‰é¡¹OPTIND=1printS=false;while getopts \"dmksahvl\" opt; do case $opt in h) #è¾“å…¥ä¸ºhelpï¼Œå°±æ‰“å°å¸®åŠ©ä¿¡æ¯ printHelp exit 0;; l) #æ”¯æŒå•ç‹¬è·å–æ”¯æŒæ–‡ä»¶åç¼€åˆ—è¡¨ echo \"Supported file types: zip tar tar.gz tar.bz2\" exit 0;; v) #æ”¯æŒæŸ¥æ‰¾ç‰ˆæœ¬å· echo \"1.0.0\" exit 0;; s) #è¿‡æ»¤Socket printS=true;; esacdone#è·å¾—å‹ç¼©åŒ…åœ°å€file=$&#123;!#&#125;#å¦‚æœä¸å­˜åœ¨å°±é€€å‡ºif [ ! -f \"$file\" ]; then echo \"File not exist!\" exit 0;fi #è·å–å‹ç¼©åç¼€fileName=`basename $file`suffix=$&#123;fileName#*.&#125;#åˆ¤æ–­æ–‡ä»¶ç±»å‹support=('tar','tar.gz','tar.bz2','zip')if [ -z `echo \"$&#123;support[@]&#125;\" | grep -w \"$suffix\"` ] ; then echo \"File type not support!\" exit 0; fi#æ‹¼æ¥æ–‡ä»¶å¤¹åœ°å€fileDir=$(dirname $file)/$&#123;fileName%%.*&#125;if [ -d $fileDir ]; then rm -rf $fileDirfimkdir $fileDircd $fileDir#è§£å‹æ–‡ä»¶case $suffix in 'tar') eval \"tar xvf $file &gt; /dev/null 2&gt;&amp;1\";; 'tar.gz') eval \"tar zxvf $file &gt; /dev/null 2&gt;&amp;1\";; 'tar.bz2') eval \"tar jxvf $file &gt; /dev/null 2&gt;&amp;1\";; 'zip') eval \"unzip -o $file &gt; /dev/null 2&gt;&amp;1\";;esacecho 'Uncompass Success!'#è·å–æ—¥å¿—åˆ—è¡¨ï¼ŒæŒ‰æ’åºåˆå¹¶åˆ°ä¸€ä¸ªæ—¥å¿—mergeFile=./merge.loglogCount=0#æœç´¢comå¼€å¤´çš„æ—¥å¿—ï¼ŒæŒ‰æ—¥æœŸæ’åºï¼Œç”¨ï¼Ÿä¸´æ—¶ä»£æ›¿ç©ºæ ¼for logName in `ls | grep 'com' | sort -n | tr \" \" \"?\"`; do logName=$&#123;logName//'?'/' '&#125; cat ./\"$logName\" &gt;&gt; $mergeFile ((logCount++))done#ä¸å­˜åœ¨æ—¥å¿—å°±æ‰“æ–­if [ $logCount -eq 0 ]; then echo \"Log not exist!\" exit fiecho 'Merge Success!'#æ‰“å°socketif [ $printS = true ]; then cat $mergeFile | grep -i 'socket' &gt;&gt; ./socket.log echo 'Filter socket'fi é‡åˆ°çš„é—®é¢˜æŸ¥è¯¢äº†å¾ˆå¤šèµ„æ–™åå†™å®Œäº†è¿™ä¸ªè„šæœ¬ï¼ŒåŸºæœ¬æ»¡è¶³äº†æˆ‘çš„éœ€æ±‚ï¼Œä¸‹é¢æ€»ç»“ä¸€ä¸‹æ€ä¹ˆè§£å†³é‡åˆ°çš„é—®é¢˜ã€‚ ä½¿ç”¨ç¯å¢ƒ\bä¸€å¼€å§‹å­¦è„šæœ¬æ—¶ï¼Œä¹¦ä¸Šéƒ½è¯´#! /bin/bashï¼Œä½†æ˜¯çœ‹é¡¹ç›®ä¸­å¤§ç¥å†™çš„è„šæœ¬ï¼Œéƒ½æ˜¯#!/usr/bin/env bashï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ è„šæœ¬ç”¨envå¯åŠ¨çš„åŸå› ï¼Œæ˜¯å› ä¸ºè„šæœ¬è§£é‡Šå™¨åœ¨linuxä¸­å¯èƒ½è¢«å®‰è£…äºä¸åŒçš„ç›®å½•ï¼Œenvå¯ä»¥åœ¨ç³»ç»Ÿçš„PATHç›®å½•ä¸­æŸ¥æ‰¾ã€‚åŒæ—¶ï¼Œenvè¿˜è§„å®šä¸€äº›ç³»ç»Ÿç¯å¢ƒå˜é‡ã€‚ ä¸åŒçš„ç³»ç»Ÿï¼Œè§£é‡Šå™¨çš„è·¯å¾„å¯èƒ½ä¹Ÿä¸åŒï¼Œæ‰€ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„æ˜¯æ¯”è¾ƒå±é™©çš„æ–¹å¼ã€‚é€šè¿‡ä»ç¯å¢ƒä¸­æŸ¥æ‰¾ï¼Œå¯ä»¥ä¿è¯å…¼å®¹æ€§ã€‚ è·å–é€‰é¡¹å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸ç”¨åˆ°å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤ä¸€èˆ¬éƒ½é…åˆé€‰é¡¹è¾¾åˆ°ä¸åŒçš„æ•ˆæœï¼Œæ¯”å¦‚æœ€å¸¸ç”¨çš„ls -alï¼Œé€šè¿‡\b-aæ¥æŒ‡å®šç»“æœåŒ…å«éšè—æ–‡ä»¶ï¼Œé€šè¿‡-lè¾¾åˆ°åˆ—è¡¨æ˜¾ç¤ºçš„æ•ˆæœã€‚ é€šè¿‡æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼Œæˆ‘å‘ç°è·å–é€‰é¡¹æ™®éçš„åšæ³•æ˜¯ä½¿ç”¨getoptså‘½ä»¤ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•åªèƒ½è·å–-hè¿™ç§çŸ­é€‰é¡¹ï¼Œå¯¹äº--helpé•¿é€‰é¡¹å°±ä¸è¡Œã€‚ ç¬¬ä¸€ç§åŠæ³•æ˜¯æ¢æˆgetoptå‘½ä»¤ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ¯ä¸ªç³»ç»Ÿéƒ½æ”¯æŒè¿™ä¸ªå‘½ä»¤ã€‚å…·ä½“ä½¿ç”¨å’Œgetoptsç±»ä¼¼ï¼Œæ¯”å¦‚getopt -\bo ab:c -l a-long:b-long ç¬¬äºŒç§æ–¹æ³•æ˜¯æŠŠæ”¯æŒçš„é•¿å‘½ä»¤è½¬æˆçŸ­å‘½ä»¤ï¼Œæˆ‘ä½¿ç”¨çš„å°±æ˜¯è¿™ç§æ–¹å¼ï¼Œç›¸å¯¹æ¥è¯´æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œä¸”caseå†™çš„æ¯”è¾ƒç»Ÿä¸€ã€‚\bé€šè¿‡shiftå–å‡ºå‚æ•°ï¼Œ\bå†set --çš„æ–¹å¼é‡å†™ï¼Œæœ€åOPTIND=1æŠŠæŒ‡é’ˆæŒ‡å›ç¬¬ä¸€ä¸ªé€‰é¡¹ã€‚ æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åç¼€æŒ‰éœ€æ±‚éœ€è¦åˆ¤æ–­åç¼€åæ¥è§£å‹ï¼Œ\bé‚£ä¹ˆå°±éœ€è¦åˆ¤æ–­tar.gzä¹‹ç±»çš„é—®é¢˜ã€‚åŒæ—¶ï¼Œå¦‚æœä¼ å…¥çš„æ–‡ä»¶ç›®å½•æ˜¯éšè—ç›®å½•ï¼Œä¹Ÿä¼šé€ æˆä¸€å®šçš„éšœç¢ã€‚æˆ‘ä»¬å‡è®¾ä¼ å…¥æ–‡ä»¶è·¯å¾„ä¸º/a/.b/c.tar.gzã€‚ ${param#pattern} ä»paramå‰é¢åˆ é™¤patternçš„æœ€å°åŒ¹é…${param##pattern} ä»paramå‰é¢åˆ é™¤patternçš„æœ€å¤§åŒ¹é…${param%pattern} ä»paramåé¢åˆ é™¤patternçš„æœ€å°åŒ¹é…${param%%pattern} ä»paramåé¢åˆ é™¤patternçš„æœ€å¤§åŒ¹é… å¦‚æœæŒ‰ç…§${fileName##*.}æ¥æˆªå–ï¼Œé‚£ä¹ˆåªèƒ½æ‹¿åˆ°gzã€‚å¦‚æœæŒ‰ç…§${fileName#*.}æ¥æˆªå–ï¼Œ\bæ‹¿åˆ°çš„åˆæ˜¯b/c.tar.gzã€‚\bé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ å¥½åœ¨æœ‰dirnameå¯ä»¥ç›´æ¥è·å–æ–‡ä»¶è·¯å¾„ï¼Œbasenameæ‹¿åˆ°æ–‡ä»¶åï¼Œå•ç‹¬å¯¹æ–‡ä»¶åè¿›è¡Œ${fileName#*.}å°±å¯ä»¥æ‹¿åˆ°tar.gzäº†ã€‚ å»é™¤ä¸å¿…è¦çš„æ‰“å°æ‰§è¡Œè§£å‹å‘½ä»¤æ—¶ï¼Œä¼šæ‰“å°è§£å‹æ­¥éª¤ï¼Œä¸€èˆ¬æ¥è¯´ä¹Ÿéœ€è¦æ˜¾ç¤ºï¼Œé‚£å¦‚æœæˆ‘ä»¬ä¸æƒ³è¦æ‰“å°å‡ºæ¥å‘¢ï¼Ÿ\bæœ‰ä¸€ä¸ªåŠæ³•å°±æ˜¯åœ¨å‘½ä»¤ä¹‹ååŠ ä¸Š&gt; /dev/null 2&gt;&amp;1 /dev/null ï¼šä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶ > ï¼šä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho â€œ123â€ &gt; /home/123.txt 1 ï¼šè¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥â€&gt;/dev/nullâ€ç­‰åŒäºâ€1&gt;/dev/nullâ€ 2 ï¼šè¡¨ç¤ºstderræ ‡å‡†é”™è¯¯ &amp; ï¼šè¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1 æ‰€ä»¥å«ä¹‰å°±æ˜¯æŠŠå‘½ä»¤è¾“å‡ºç»“æœå’Œé”™è¯¯è¾“å‡ºé‡å®šå‘ï¼Œä½¿å¾—è¾“å‡ºä¸åœ¨å½“å‰å±å¹•æ˜¾ç¤ºï¼Œ\bç”±äºnullæ¯”è¾ƒç‰¹æ®Šï¼Œå‘è¿™ä¸ªæ–‡ä»¶è¾“å…¥ç­‰äºè¿›å…¥é»‘æ´ï¼Œå› æ­¤è¾¾åˆ°æ•ˆæœã€‚ æ•°ç»„ä¸ç©ºæ ¼ä½¿ç”¨ls | grepçš„æ–¹å¼æ¥è¿‡æ»¤ç»“æœè·å–æ–‡ä»¶åæ•°ç»„çš„æœ€å¤§é—®é¢˜æ˜¯ï¼Œå¦‚æœæ–‡ä»¶ååŒ…å«ç©ºæ ¼ï¼Œé‚£ä¹ˆå‰åä¼šè¢«åˆ†å‰²æˆä¸¤ä¸ªå•å…ƒï¼Œå¯¼è‡´å¤„ç†æ¯”è¾ƒå›°éš¾ã€‚ æ¯”è¾ƒè®¨å·§çš„æ–¹æ³•æ˜¯ä¸´æ—¶ç”¨ç‰¹æ®Šç¬¦å·ä»£æ›¿ç©ºæ ¼ï¼Œåœ¨ä½¿ç”¨æ—¶å†æ›¿æ¢å›æ¥ã€‚è¿™ç§æ–¹æ³•ä¸ä¼šæ”¹å˜æ–‡ä»¶åï¼Œä¹Ÿä¸ç”¨å†™å¤æ‚çš„æ•°ç»„åˆå¹¶ï¼Œæ¯”è¾ƒç¬¦åˆç®€å•çš„è®¾è®¡ã€‚ 12tr \" \" \"?\"$&#123;logName//'?'/' '&#125; æ€»ç»“é€šè¿‡è¿™æ¬¡ç®€å•çš„è„šæœ¬å®éªŒï¼Œå¯¹shellæœ‰äº†æ–°çš„è®¤è¯†ï¼Œ\båŠæ—¶è®°å½•é‡åˆ°çš„é—®é¢˜ï¼Œç›¸ä¿¡ä¸‹æ¬¡ä¼šæ›´æœ‰å°è±¡ã€‚ä½¿ç”¨è„šæœ¬ï¼Œå¯ä»¥è®©å·¥ä½œæ›´æœ‰æ•ˆç‡ï¼Œç›¸ä¿¡ä»¥åä¹Ÿä¼šè¶Šç”¨è¶Šå¤šã€‚","categories":[{"name":"Shell","slug":"Shell","permalink":"https://vanchchen.github.io/categories/Shell/"}],"tags":[]},{"title":"Categoryæ¢ç´¢","slug":"Categoryæ¢ç´¢","date":"2018-09-17T07:29:29.000Z","updated":"2018-10-08T01:55:15.822Z","comments":true,"path":"p/5cb0.html","link":"","permalink":"https://vanchchen.github.io/p/5cb0.html","excerpt":"","text":"ä»€ä¹ˆæ˜¯\bCategory?Categoryæ˜¯Objective-C 2.0ä¹‹åæ·»åŠ çš„è¯­è¨€ç‰¹æ€§ï¼ŒCategoryçš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºå·²ç»å­˜åœ¨çš„ç±»æ·»åŠ æ–¹æ³•ï¼Œä¸€èˆ¬ç§°ä¸ºåˆ†ç±»ï¼Œæ–‡ä»¶åæ ¼å¼æ˜¯â€\bNSObject+A.hâ€ã€‚ 123456789struct category_t &#123; const char *name; classref_t cls; struct method_list_t *instanceMethods; struct method_list_t *classMethods; struct protocol_list_t *protocols; struct property_list_t *instanceProperties; struct property_list_t *_classProperties;&#125; ä»ç»“æ„èƒ½çœ‹å‡ºåˆ†ç±»å¯ä»¥æ‰©å±•å®ä¾‹æ–¹æ³•åˆ—è¡¨ã€ç±»æ–¹æ³•åˆ—è¡¨ã€åè®®åˆ—è¡¨ï¼Œä¹Ÿæ”¯æŒæ‰©å±•å±æ€§ï¼Œä½†ä¸æ”¯æŒæ‰©å±•æˆå‘˜å˜é‡ï¼ˆä¹‹åä¼šè¯´ï¼‰ã€‚ ä¸€èˆ¬ä½¿ç”¨çš„åœºæ™¯æœ‰æ‰©å±•ç°æœ‰ç±»æ–¹æ³•ã€ä»£ç åˆ†åŒºã€æ·»åŠ ç§æœ‰æ–¹æ³•ï¼ˆä¸å¯¹å¤–æš´éœ²category.hï¼‰ã€æ¨¡æ‹Ÿå¤šç»§æ‰¿ï¼ˆä½¿ç”¨å…³è”å¯¹è±¡çš„æ–¹å¼æ·»åŠ \bå±æ€§å®ç°ï¼‰ ä»€ä¹ˆæ˜¯Extensionï¼ŸExtensionä¸€èˆ¬è¢«ç§°ä¸º\bç±»æ‰©å±•ã€\båŒ¿ååˆ†ç±»ï¼Œ\bç”¨äºå®šä¹‰ç§æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä¸å¯è¢«ç»§æ‰¿ã€‚åªèƒ½ä¾é™„è‡ªå®šä¹‰ç±»å†™äº.mä¸­ï¼Œå®šä¹‰ä¸€èˆ¬ä¸º: 12345@interface ViewController ()@\bproperty (nonatomic, strong) NSObject *obj;@end ç±»æ‰©å±•æ”¯æŒ\bå†™åœ¨å¤šä¸ª.hæ–‡ä»¶ï¼Œä½†éƒ½å¿…é¡»åœ¨.mæ–‡ä»¶ä¸­å¼•ç”¨ï¼Œä¸”ä¸èƒ½æœ‰è‡ªå·±çš„å®ç°ã€‚ ç±»æ‰©å±•å¾ˆå¤šæ—¶å€™ä¼šä¸åˆ†ç±»ææ··ï¼Œ\bæˆ‘åœ¨æ–‡åé—®ç­”ç¯èŠ‚è¯¦ç»†æ•´ç†äº†ä»–ä»¬çš„åŒºåˆ«ã€‚ \bCategoryå¦‚ä½•åŠ è½½çš„ï¼Ÿ1234567891011121314151617181920212223242526struct objc_class : objc_object &#123; Class superclass; class_data_bits_t bits; class_rw_t *data() &#123; return bits.data(); &#125; ...&#125;struct class_rw_t &#123; const class_ro_t *ro; method_array_t methods; property_array_t properties; protocol_array_t protocols; ...&#125;struct class_ro_t &#123; const char * name; method_list_t * baseMethodList; protocol_list_t * baseProtocols; const ivar_list_t * ivars; //åªæœ‰roæ‰æœ‰å®ä¾‹å˜é‡è¡¨ property_list_t *baseProperties; ...&#125;; å…ˆç®€å•äº†è§£ä¸€ä¸‹Class\bå¯¹è±¡çš„ç»“æ„ï¼Œæ¯ä¸ª\bobjc_classéƒ½åŒ…å«æœ‰class_data_bits_tæ•°æ®ä½ï¼Œå…¶ä¸­å‚¨å­˜äº†class_rw_tçš„æŒ‡é’ˆåœ°å€å’Œä¸€äº›å…¶ä»–æ ‡è®°ã€‚class_rw_tä¸­åŒ…å«æœ‰å±æ€§æ–¹æ³•åè®®åˆ—è¡¨ï¼Œä»¥åŠclass_ro_tæŒ‡é’ˆåœ°å€ã€‚è€Œåœ¨class_ro_tç»“æ„ä¸­ï¼Œå‚¨å­˜çš„æ˜¯ç¼–è¯‘å™¨å†³å®šçš„å±æ€§æ–¹æ³•åè®®ã€‚ é‚£ä¹ˆæ˜¯æ€ä¹ˆè¿è¡Œçš„å‘¢ï¼Ÿåœ¨ç¼–è¯‘æœŸç±»çš„ç»“æ„ä¸­çš„\bclass_data_bits_tæŒ‡å‘çš„æ˜¯ä¸€ä¸ª class_ro_tæŒ‡é’ˆã€‚ åœ¨è¿è¡Œæ—¶è°ƒç”¨realizeClassæ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸€ä¸ªclass_rw_tç»“æ„ä½“ï¼Œè®¾ç½®roå€¼ä¸ºåŸæ•°æ®ä¸­çš„class_ro_tåè®¾ä¸ºæ•°æ®ä½ä¸­çš„æŒ‡å‘ï¼Œæœ€åè°ƒç”¨\bmethodizeClassæ–¹æ³•åŠ è½½ã€‚ 12345678910111213141516171819202122232425262728293031static void methodizeClass(Class cls)&#123; auto rw = cls-&gt;data(); auto ro = rw-&gt;ro; //ä»roä¸­åŠ è½½æ–¹æ³•è¡¨ method_list_t *list = ro-&gt;baseMethods(); if (list) &#123; prepareMethodLists(cls, &amp;list, 1, YES, isBundleClass(cls)); rw-&gt;methods.attachLists(&amp;list, 1); &#125; //åŠ è½½å±æ€§ property_list_t *proplist = ro-&gt;baseProperties; if (proplist) &#123; rw-&gt;properties.attachLists(&amp;proplist, 1); &#125; //åŠ è½½åè®® protocol_list_t *protolist = ro-&gt;baseProtocols; if (protolist) &#123; rw-&gt;protocols.attachLists(&amp;protolist, 1); &#125; //åŸºç±»æ·»åŠ åˆå§‹åŒ–æ–¹æ³• if (cls-&gt;isRootMetaclass()) &#123; addMethod(cls, SEL_initialize, (IMP)&amp;objc_noop_imp, \"\", NO); &#125; //åŠ è½½åˆ†ç±» category_list *cats = unattachedCategoriesForClass(cls, true /*realizing*/); attachCategories(cls, cats, false /*don't flush caches*/); if (cats) free(cats);&#125; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨methodizeClassä¸­åŠ è½½äº†åŸå…ˆç±»åœ¨ç¼–è¯‘æœŸå†³å®šçš„æ–¹æ³•å±æ€§å’Œåè®®ï¼Œç„¶åè·å–äº†æœªè¿æ¥çš„åˆ†ç±»è¡¨ï¼Œå°†åˆ—è¡¨ä¸­çš„æ‰©å±•æ–¹æ³•æ·»åŠ åˆ°è¿è¡ŒæœŸç±»ä¸­ã€‚ Categoryæ–¹æ³•è¦†ç›–\b\bå¦‚æœä¸åŒçš„åˆ†ç±»å®ç°äº†ç›¸åŒåå­—çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè°ƒç”¨æ—¶ä¼šä½¿ç”¨æœ€ååŠ å…¥çš„å®ç°ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åŠ è½½Categorydyldé“¾æ¥å¹¶åˆå§‹åŒ–äºŒè¿›åˆ¶æ–‡ä»¶åï¼Œäº¤ç”±ImageLoaderè¯»å–ï¼Œæ¥ç€é€šçŸ¥runtime\bå¤„ç†ï¼Œruntime\b\bè°ƒç”¨map_imagesè§£æï¼Œç„¶åæ‰§è¡Œ_read_imagesåˆ†ææ–‡ä»¶ä¸­åŒ…å«çš„ç±»å’Œåˆ†ç±»ã€‚ 1234567891011121314151617181920212223242526272829303132333435//åŠ è½½åˆ†ç±»category_t **catlist = _getObjc2CategoryList(hi, &amp;count);bool hasClassProperties = hi-&gt;info()-&gt;hasCategoryClassProperties();for (i = 0; i &lt; count; i++) &#123; category_t *cat = catlist[i]; Class cls = remapClass(cat-&gt;cls); if (!cls) &#123; //åˆ†ç±»æŒ‡å®šçš„ç±»è¿˜æ²¡åŠ è½½ï¼Œ\bå¯èƒ½æ˜¯é“¾æ¥åº“é¡ºåºçš„é—®é¢˜ catlist[i] = nil; continue; &#125; \b//æ·»åŠ åˆ†ç±»åˆ°ç±»çš„åˆ†ç±»è¡¨ä¸­ï¼Œä¼ºæœºé‡è½½å…¥ bool classExists = NO; if (cat-&gt;instanceMethods || cat-&gt;protocols || cat-&gt;instanceProperties) &#123; addUnattachedCategoryForClass(cat, cls, hi); if (cls-&gt;isRealized()) &#123; remethodizeClass(cls); classExists = YES; &#125; &#125; //æ·»åŠ åˆ†ç±»åˆ°å…ƒç±»ä¸­ if (cat-&gt;classMethods || cat-&gt;protocols || (hasClassProperties &amp;&amp; cat-&gt;_classProperties)) &#123; addUnattachedCategoryForClass(cat, cls-&gt;ISA(), hi); if (cls-&gt;ISA()-&gt;isRealized()) &#123; remethodizeClass(cls-&gt;ISA()); &#125; &#125;&#125; æ·»åŠ æ–¹æ³•å±æ€§å’Œåè®®å¦‚æœæœ‰æ–°å¢çš„åˆ†ç±»ï¼Œå°±\båˆ†åˆ«æ·»åŠ åˆ°åŸç±»å’Œmetaç±»ï¼Œå¹¶é€šè¿‡remethodizeClassæ›´æ–°ï¼Œå…·ä½“å°±æ˜¯è°ƒç”¨attachCategoriesæ–¹æ³•æŠŠåˆ†ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½æ·»åŠ åˆ°æŒ‡å®šç±»ä¸­ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253static void attachCategories(Class cls, category_list *cats, bool flush_caches)&#123; if (!cats) return; bool isMeta = cls-&gt;isMetaClass(); //æ–°å»ºæ•°ç»„æŒ‡é’ˆ method_list_t **mlists = (method_list_t **) malloc(cats-&gt;count * sizeof(*mlists)); property_list_t **proplists = (property_list_t **) malloc(cats-&gt;count * sizeof(*proplists)); protocol_list_t **protolists = (protocol_list_t **) malloc(cats-&gt;count * sizeof(*protolists)); int mcount = 0; int propcount = 0; int protocount = 0; int i = cats-&gt;count;//å€’åºè·å–æœ€æ–°çš„åˆ†ç±» bool fromBundle = NO; while (i--) &#123; auto&amp; entry = cats-&gt;list[i]; //åˆ†åˆ«è·å–åˆ—è¡¨ method_list_t *mlist = entry.cat-&gt;methodsForMeta(isMeta); if (mlist) &#123; mlists[mcount++] = mlist; fromBundle |= entry.hi-&gt;isBundle(); &#125; property_list_t *proplist = entry.cat-&gt;propertiesForMeta(isMeta, entry.hi); if (proplist) &#123; proplists[propcount++] = proplist; &#125; protocol_list_t *protolist = entry.cat-&gt;protocols; if (protolist) &#123; protolists[protocount++] = protolist; &#125; &#125; auto rw = cls-&gt;data(); //åŠ è½½åˆ—è¡¨åˆ°rwä¸­ prepareMethodLists(cls, mlists, mcount, NO, fromBundle); rw-&gt;methods.attachLists(mlists, mcount); free(mlists); if (flush_caches &amp;&amp; mcount &gt; 0) flushCaches(cls); rw-&gt;properties.attachLists(proplists, propcount); free(proplists); rw-&gt;protocols.attachLists(protolists, protocount); free(protolists);&#125; 123456789101112131415161718192021222324252627282930void attachLists(List* const * addedLists, uint32_t addedCount) &#123; if (addedCount == 0) return; if (hasArray()) &#123; // many lists -&gt; many lists uint32_t oldCount = array()-&gt;count; uint32_t newCount = oldCount + addedCount; setArray((array_t *)realloc(array(), array_t::byteSize(newCount))); array()-&gt;count = newCount; memmove(array()-&gt;lists + addedCount, array()-&gt;lists, oldCount * sizeof(array()-&gt;lists[0])); memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0])); &#125; else if (!list &amp;&amp; addedCount == 1) &#123; // 0 lists -&gt; 1 list list = addedLists[0]; &#125; else &#123; // 1 list -&gt; many lists List* oldList = list; uint32_t oldCount = oldList ? 1 : 0; uint32_t newCount = oldCount + addedCount; setArray((array_t *)malloc(array_t::byteSize(newCount))); array()-&gt;count = newCount; if (oldList) array()-&gt;lists[addedCount] = oldList; memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0])); &#125; &#125; å¯ä»¥çœ‹åˆ°æœ€åè°ƒç”¨äº†rw-&gt;methods.attachLists(mlists, mcount); æŠŠæ–°å¢åˆ†ç±»ä¸­çš„æ–¹æ³•åˆ—è¡¨æ·»åŠ åˆ°å®é™…è¿è¡Œæ—¶æŸ¥è¯¢çš„æ–¹æ³•åˆ—è¡¨\bå¤´éƒ¨ã€‚ åœ¨\bè¿›è¡Œæ–¹æ³•è°ƒç”¨æ—¶ä¼šä»å¤´éƒ¨æŸ¥è¯¢ï¼Œä¸€æ—¦æŸ¥åˆ°åå°±è¿”å›ç»“æœï¼Œå› æ­¤åç¼–è¯‘çš„æ–‡ä»¶\bä¸­çš„æ–¹æ³•ä¼šè¢«ä¼˜å…ˆè°ƒç”¨ã€‚ åŒæ—¶ä¹‹å‰æ·»åŠ çš„æ–¹æ³•å®ç°\bä¹Ÿä¿å­˜äº†ï¼Œå¯ä»¥é€šè¿‡\bè·å–åŒåæ–¹æ³•çš„æ–¹å¼æŸ¥æ‰¾åŸç±»çš„å®ç°ã€‚ Categoryå®ç°å±æ€§åˆ†ç±»ä¸èƒ½æ·»åŠ æˆå‘˜å˜é‡\bå±æ€§ï¼ˆPropertyï¼‰åŒ…å«äº†æˆå‘˜å˜é‡ï¼ˆIvarï¼‰å’ŒSetter&amp;Getterã€‚ å¯ä»¥åœ¨åˆ†ç±»ä¸­å®šä¹‰å±æ€§ï¼Œä½†ç”±äºåˆ†ç±»æ˜¯åœ¨è¿è¡Œæ—¶æ·»åŠ åˆ†ç±»å±æ€§åˆ°ç±»çš„å±æ€§åˆ—è¡¨ä¸­ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰åˆ›å»ºå¯¹åº”çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•å®ç°ã€‚ å…³è”å¯¹è±¡å¦‚æœæˆ‘ä»¬æƒ³è®©åˆ†ç±»å®ç°æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸€èˆ¬éƒ½é€šè¿‡å…³è”å¯¹è±¡çš„æ–¹å¼ã€‚12345678910111213141516171819// å£°æ˜æ–‡ä»¶@interface TestObject (Category)@property (nonatomic, strong) NSObject *object;@end// å®ç°æ–‡ä»¶static void *const kAssociatedObjectKey = (void *)&amp;kAssociatedObjectKey;@implementation TestObject (Category)- (NSObject *)object &#123; return objc_getAssociatedObject(self, kAssociatedObjectKey);&#125;- (void)setObject:(NSObject *)object &#123; objc_setAssociatedObject(self, kAssociatedObjectKey, object, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;@end è¿™ç§æ–¹å¼å¯ä»¥å®ç°å­˜å–\bå¯¹è±¡ï¼Œä½†æ˜¯ä¸èƒ½è·å–_objectå˜é‡ã€‚ é—®ç­”åˆ†ç±»å’Œæ‰©å±•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ1.åˆ†ç±»å¤šç”¨äºæ‰©å±•æ–¹æ³•å®ç°ï¼Œç±»æ‰©å±•å¤šç”¨äºç”³æ˜ç§æœ‰å˜é‡å’Œæ–¹æ³•ã€‚ 2.ç±»æ‰©å±•ä½œç”¨åœ¨ç¼–è¯‘æœŸï¼Œç›´æ¥å’ŒåŸç±»åœ¨ä¸€èµ·ï¼Œè€Œåˆ†ç±»ä½œç”¨åœ¨è¿è¡Œæ—¶ï¼ŒåŠ è½½ç±»çš„æ—¶å€™åŠ¨æ€æ·»åŠ åˆ°åŸç±»ä¸­ã€‚ 3.ç±»æ‰©å±•å¯ä»¥å®šä¹‰å±æ€§ï¼Œåˆ†ç±»ä¸­å®šä¹‰çš„å±æ€§åªä¼šç”³æ˜setter/getterï¼Œå¹¶æ²¡æœ‰ç›¸å…³å®ç°å’Œå˜é‡ã€‚ åˆ†ç±»æœ‰å“ªäº›å±€é™æ€§ï¼Ÿ1.åˆ†ç±»\båªèƒ½ç»™ç°æœ‰çš„ç±»åŠ æ–¹æ³•æˆ–åè®®ï¼Œä¸èƒ½æ·»åŠ \bå®ä¾‹å˜é‡ï¼ˆivarï¼‰ã€‚ 2.åˆ†ç±»æ·»åŠ çš„æ–¹æ³•å¦‚æœä¸ç°æœ‰çš„é‡åï¼Œä¼šè¦†ç›–åŸæœ‰æ–¹æ³•çš„å®ç°ã€‚å¦‚æœå¤šä¸ªåˆ†ç±»æ–¹æ³•éƒ½é‡åï¼Œåˆ™æ ¹æ®ç¼–è¯‘é¡ºåºæ‰§è¡Œæœ€åä¸€ä¸ªã€‚ åˆ†ç±»çš„ç»“æ„ä½“é‡Œé¢æœ‰å“ªäº›æˆå‘˜ï¼Ÿåˆ†ç±»ç»“æ„ä½“åŒ…å«äº†åˆ†ç±»åï¼Œç»‘å®šçš„ç±»ï¼Œå®ä¾‹ä¸ç±»æ–¹æ³•åˆ—è¡¨ï¼Œå®ä¾‹ä¸ç±»æ–¹æ³•å±æ€§ä»¥åŠåè®®è¡¨ã€‚ å‚è€ƒæ·±å…¥ç†è§£Objective-Cï¼šCategory \bç¥ç»ç—…é™¢ Objective-C Runtime å…¥é™¢ç¬¬ä¸€å¤©â€”â€” isa å’Œ Class æ¢ç§˜Runtime - æ·±å…¥å‰–æCategory","categories":[{"name":"iOS","slug":"iOS","permalink":"https://vanchchen.github.io/categories/iOS/"}],"tags":[{"name":"åŸç†åˆ†æ","slug":"åŸç†åˆ†æ","permalink":"https://vanchchen.github.io/tags/åŸç†åˆ†æ/"}]},{"title":"iOSé¢è¯•é¢˜","slug":"iOSé¢è¯•é¢˜","date":"2018-09-14T09:40:01.000Z","updated":"2018-10-08T09:19:25.641Z","comments":true,"path":"p/6ea5.html","link":"","permalink":"https://vanchchen.github.io/p/6ea5.html","excerpt":"","text":"å‰è¨€æœ¬æ–‡å€Ÿé‰´æ•´ç†äº†iOSé«˜çº§å¼€å‘å¸¸è§çš„é¢è¯•é¢˜ï¼Œå¹¶ä¸”åˆ†åšå®¢ä¸€ä¸€åˆ†æï¼Œå¸Œæœ›èƒ½å’Œå¤§å®¶ä¸€èµ·è¿›æ­¥å­¦ä¹ ã€‚ æ¬¢è¿å¤§å®¶å…³æ³¨æˆ‘çš„ GithubğŸ‘ä»¥åŠç›¸å…³åšå®¢ ç®€ä¹¦ åšå®¢å›­ å¤§å®¶çš„é¼“åŠ±æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›ğŸ˜„ iOSåŸºç¡€é¢˜ åˆ†ç±»å’Œæ‰©å±•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¯ä»¥åˆ†åˆ«ç”¨æ¥åšä»€ä¹ˆï¼Ÿåˆ†ç±»æœ‰å“ªäº›å±€é™æ€§ï¼Ÿåˆ†ç±»çš„ç»“æ„ä½“é‡Œé¢æœ‰å“ªäº›æˆå‘˜ï¼Ÿ Categoryæ¢ç´¢ è®²ä¸€ä¸‹atomicçš„å®ç°æœºåˆ¶ï¼›ä¸ºä»€ä¹ˆä¸èƒ½ä¿è¯ç»å¯¹çš„çº¿ç¨‹å®‰å…¨ï¼ˆæœ€å¥½å¯ä»¥ç»“åˆåœºæ™¯æ¥è¯´ï¼‰ï¼Ÿ è¢«weakä¿®é¥°çš„å¯¹è±¡åœ¨è¢«é‡Šæ”¾çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ˜¯å¦‚ä½•å®ç°çš„ï¼ŸçŸ¥é“sideTableä¹ˆï¼Ÿé‡Œé¢çš„ç»“æ„å¯ä»¥ç”»å‡ºæ¥ä¹ˆï¼Ÿ å…³è”å¯¹è±¡æœ‰ä»€ä¹ˆåº”ç”¨ï¼Œç³»ç»Ÿå¦‚ä½•ç®¡ç†å…³è”å¯¹è±¡ï¼Ÿå…¶è¢«é‡Šæ”¾çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨å°†å…¶æŒ‡é’ˆç½®ç©ºä¹ˆï¼Ÿ AssociatedObjectå…³è”å¯¹è±¡åŸç†å®ç° KVOçš„åº•å±‚å®ç°ï¼Ÿå¦‚ä½•å–æ¶ˆç³»ç»Ÿé»˜è®¤çš„KVOå¹¶æ‰‹åŠ¨è§¦å‘ï¼ˆç»™KVOçš„è§¦å‘è®¾å®šæ¡ä»¶ï¼šæ”¹å˜çš„å€¼ç¬¦åˆæŸä¸ªæ¡ä»¶æ—¶å†è§¦å‘KVOï¼‰ï¼Ÿ Autoreleasepoolæ‰€ä½¿ç”¨çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼ŸAutoreleasePoolPageç»“æ„ä½“äº†è§£ä¹ˆï¼Ÿ è®²ä¸€ä¸‹å¯¹è±¡ï¼Œç±»å¯¹è±¡ï¼Œå…ƒç±»ï¼Œè·Ÿå…ƒç±»ç»“æ„ä½“çš„ç»„æˆä»¥åŠä»–ä»¬æ˜¯å¦‚ä½•ç›¸å…³è”çš„ï¼Ÿä¸ºä»€ä¹ˆå¯¹è±¡æ–¹æ³•æ²¡æœ‰ä¿å­˜çš„å¯¹è±¡ç»“æ„ä½“é‡Œï¼Œè€Œæ˜¯ä¿å­˜åœ¨ç±»å¯¹è±¡çš„ç»“æ„ä½“é‡Œï¼Ÿ class_ro_t å’Œ class_rw_t çš„åŒºåˆ«ï¼Ÿ iOS ä¸­å†…çœçš„å‡ ä¸ªæ–¹æ³•ï¼Ÿclassæ–¹æ³•å’Œobjc_getClassæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«? åœ¨è¿è¡Œæ—¶åˆ›å»ºç±»çš„æ–¹æ³•objc_allocateClassPairçš„æ–¹æ³•åå°¾éƒ¨ä¸ºä»€ä¹ˆæ˜¯pairï¼ˆæˆå¯¹çš„æ„æ€ï¼‰ï¼Ÿ ä¸€ä¸ªintå˜é‡è¢«__blockä¿®é¥°ä¸å¦çš„åŒºåˆ«ï¼Ÿ\\12. ä¸ºä»€ä¹ˆåœ¨blockå¤–éƒ¨ä½¿ç”¨__weakä¿®é¥°çš„åŒæ—¶éœ€è¦åœ¨å†…éƒ¨ä½¿ç”¨__strongä¿®é¥°ï¼Ÿ RunLoopçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„å†…éƒ¨å·¥ä½œæœºåˆ¶äº†è§£ä¹ˆï¼Ÿï¼ˆæœ€å¥½ç»“åˆçº¿ç¨‹å’Œå†…å­˜ç®¡ç†æ¥è¯´ï¼‰ å“ªäº›åœºæ™¯å¯ä»¥è§¦å‘ç¦»å±æ¸²æŸ“ï¼Ÿï¼ˆçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ iOS å®æˆ˜é¢˜ AppDelegateå¦‚ä½•ç˜¦èº«ï¼Ÿ åå°„æ˜¯ä»€ä¹ˆï¼Ÿå¯ä»¥ä¸¾å‡ºå‡ ä¸ªåº”ç”¨åœºæ™¯ä¹ˆï¼Ÿï¼ˆçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ æœ‰å“ªäº›åœºæ™¯æ˜¯NSOperationæ¯”GCDæ›´å®¹æ˜“å®ç°çš„ï¼Ÿï¼ˆæˆ–æ˜¯NSOperationä¼˜äºGCDçš„å‡ ç‚¹ï¼ŒçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ App å¯åŠ¨ä¼˜åŒ–ç­–ç•¥ï¼Ÿæœ€å¥½ç»“åˆå¯åŠ¨æµç¨‹æ¥è¯´ï¼ˆmain()å‡½æ•°çš„æ‰§è¡Œå‰åéƒ½åˆ†åˆ«è¯´ä¸€ä¸‹ï¼ŒçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ App æ— ç—•åŸ‹ç‚¹çš„æ€è·¯äº†è§£ä¹ˆï¼Ÿä½ è®¤ä¸ºç†æƒ³çš„æ— ç—•åŸ‹ç‚¹ç³»ç»Ÿåº”è¯¥å…·å¤‡å“ªäº›ç‰¹ç‚¹ï¼Ÿï¼ˆçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ ä½ çŸ¥é“æœ‰å“ªäº›æƒ…å†µä¼šå¯¼è‡´appå´©æºƒï¼Œåˆ†åˆ«å¯ä»¥ç”¨ä»€ä¹ˆæ–¹æ³•æ‹¦æˆªå¹¶åŒ–è§£ï¼Ÿï¼ˆçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ ä½ çŸ¥é“æœ‰å“ªäº›æƒ…å†µä¼šå¯¼è‡´appå¡é¡¿ï¼Œåˆ†åˆ«å¯ä»¥ç”¨ä»€ä¹ˆæ–¹æ³•æ¥é¿å…ï¼Ÿï¼ˆçŸ¥é“å¤šå°‘è¯´å¤šå°‘ï¼‰ ç½‘ç»œé¢˜ App ç½‘ç»œå±‚æœ‰å“ªäº›ä¼˜åŒ–ç­–ç•¥ï¼Ÿ TCPä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹ï¼Ÿ å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„åŒºåˆ«ï¼Ÿåˆ†åˆ«æœ‰å“ªäº›ç®—æ³•çš„å®ç°ï¼Ÿ HTTPSçš„æ¡æ‰‹æµç¨‹ï¼Ÿä¸ºä»€ä¹ˆå¯†é’¥çš„ä¼ é€’éœ€è¦ä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ŸåŒå‘è®¤è¯äº†è§£ä¹ˆï¼Ÿ HTTPSæ˜¯å¦‚ä½•å®ç°éªŒè¯èº«ä»½å’ŒéªŒè¯å®Œæ•´æ€§çš„ï¼Ÿ å¦‚ä½•ç”¨CharlesæŠ“HTTPSçš„åŒ…ï¼Ÿå…¶ä¸­åŸç†å’Œæµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ï¼Ÿå¦‚ä½•é¿å…ï¼Ÿ è®¡ç®—æœºç³»ç»Ÿé¢˜ äº†è§£ç¼–è¯‘çš„è¿‡ç¨‹ä¹ˆï¼Ÿåˆ†ä¸ºå“ªå‡ ä¸ªæ­¥éª¤ï¼Ÿ é™æ€é“¾æ¥äº†è§£ä¹ˆï¼Ÿé™æ€åº“å’ŒåŠ¨æ€åº“çš„åŒºåˆ«ï¼Ÿ å†…å­˜çš„å‡ å¤§åŒºåŸŸï¼Œå„è‡ªçš„èŒèƒ½åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ staticå’Œconstæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ äº†è§£å†…è”å‡½æ•°ä¹ˆï¼Ÿ ä»€ä¹ˆæ—¶å€™ä¼šå‡ºç°æ­»é”ï¼Ÿå¦‚ä½•é¿å…ï¼Ÿ è¯´ä¸€è¯´ä½ å¯¹çº¿ç¨‹å®‰å…¨çš„ç†è§£ï¼Ÿ åˆ—ä¸¾ä½ çŸ¥é“çš„çº¿ç¨‹åŒæ­¥ç­–ç•¥ï¼Ÿ æœ‰å“ªå‡ ç§é”ï¼Ÿå„è‡ªçš„åŸç†ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæœ€å¥½å¯ä»¥ç»“åˆä½¿ç”¨åœºæ™¯æ¥è¯´ è®¾è®¡æ¨¡å¼é¢˜ é™¤äº†å•ä¾‹ï¼Œè§‚å¯Ÿè€…è®¾è®¡æ¨¡å¼ä»¥å¤–ï¼Œè¿˜çŸ¥é“å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿåˆ†åˆ«ä»‹ç»ä¸€ä¸‹ æœ€å–œæ¬¢å“ªä¸ªè®¾è®¡æ¨¡å¼ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ iOS SDK é‡Œé¢æœ‰å“ªäº›è®¾è®¡æ¨¡å¼çš„å®è·µï¼Ÿ **è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ **è®¾è®¡æ¨¡å¼çš„æˆå‘˜æ„æˆä»¥åŠå·¥ä½œæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ **è®¾è®¡æ¨¡å¼çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ æ¶æ„ &amp; è®¾è®¡é¢˜ MVCå’ŒMVVMçš„åŒºåˆ«ï¼ŸMVVMå’ŒMVPçš„åŒºåˆ«ï¼Ÿ é¢å‘å¯¹è±¡çš„å‡ ä¸ªè®¾è®¡åŸåˆ™äº†è§£ä¹ˆï¼Ÿæœ€å¥½å¯ä»¥ç»“åˆåœºæ™¯æ¥è¯´ã€‚ å¯ä»¥è¯´å‡ ä¸ªé‡æ„çš„æŠ€å·§ä¹ˆï¼Ÿä½ è§‰å¾—é‡æ„é€‚åˆä»€ä¹ˆæ—¶å€™æ¥åšï¼Ÿ ä½ è§‰å¾—æ¡†æ¶å’Œè®¾è®¡æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ çœ‹è¿‡å“ªäº›ç¬¬ä¸‰æ–¹æ¡†æ¶çš„æºç ï¼Œå®ƒä»¬æ˜¯æ€ä¹ˆè®¾è®¡çš„ï¼Ÿè®¾è®¡å¥½çš„åœ°æ–¹åœ¨å“ªé‡Œï¼Œä¸å¥½çš„åœ°æ–¹åœ¨å“ªé‡Œï¼Œå¦‚ä½•æ”¹è¿›ï¼Ÿï¼ˆè¿™é“é¢˜çš„åä¸‰ä¸ªé—®é¢˜çš„éš¾åº¦å·²ç»å¾ˆé«˜äº†ï¼Œå¦‚æœä¸æ˜¯å¤ªNçš„å…¬å¸ä¸å»ºè®®æ·±ç©¶ï¼‰ æ•°æ®ç»“æ„&amp;ç®—æ³•é¢˜ é“¾è¡¨å’Œæ•°ç»„çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæ’å…¥å’ŒæŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ å“ˆå¸Œè¡¨æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå¦‚ä½•è§£å†³åœ°å€å†²çªï¼Ÿ æ’åºé¢˜ï¼šå†’æ³¡æ’åºï¼Œé€‰æ‹©æ’åºï¼Œæ’å…¥æ’åºï¼Œå¿«é€Ÿæ’åºï¼ˆäºŒè·¯ï¼Œä¸‰è·¯ï¼‰èƒ½å†™å‡ºé‚£äº›ï¼Ÿ é“¾è¡¨é¢˜ï¼šå¦‚ä½•æ£€æµ‹é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ï¼Ÿå¦‚ä½•åˆ é™¤é“¾è¡¨ä¸­ç­‰äºæŸä¸ªå€¼çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Ÿ æ•°ç»„é¢˜ï¼šå¦‚ä½•åœ¨æœ‰åºæ•°ç»„ä¸­æ‰¾å‡ºå’Œç­‰äºç»™å®šå€¼çš„ä¸¤ä¸ªå…ƒç´ ï¼Ÿå¦‚ä½•åˆå¹¶ä¸¤ä¸ªæœ‰åºçš„æ•°ç»„ä¹‹åä¿æŒæœ‰åºï¼Ÿ äºŒå‰æ ‘é¢˜ï¼šå¦‚ä½•åè½¬äºŒå‰æ ‘ï¼Ÿå¦‚ä½•éªŒè¯ä¸¤ä¸ªäºŒå‰æ ‘æ˜¯å®Œå…¨ç›¸ç­‰çš„ï¼Ÿ å¼•ç”¨å‡ºä¸€å¥— iOS é«˜çº§é¢è¯•é¢˜","categories":[{"name":"iOS","slug":"iOS","permalink":"https://vanchchen.github.io/categories/iOS/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://vanchchen.github.io/tags/é¢è¯•/"}]}]}